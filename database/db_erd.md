CMS Database Schema
===================

* CMS Setup Tables
	- [Fs Objects Table](#fs-objects-table)
	- [Tokens Table](#tokens-table)

* People Tables
	- [Users Table](#users-table)
	- [Admins Table](#admins-table)
	- [Teams Table](#teams-table)
	- [Managers Table](#managers-table)
	    - [User Test Managers Table](#user-test-managers-table)

* Contest Setup Tables
    - [Contests Table](#contests-table)
    - [Print Jobs Table](#print-jobs-table)
    * Communication Tables
        - [Announcements Table](#announcements-table)
        - [Messages Table](#messages-table)
    * Questions Tables
        - [Datasets Table](#datasets-table)
        - [Questions Table](#questions-table)
        - [Statements Table](#statements-table)
        - [Tasks Table](#tasks-table)
        - [Testcases Table](#testcases-table)
        - [User Tests Table](#user-tests-table)
    * Submission Tables
        - [Executables Table](#executables-table)
            - [User Test Executables Table](#user-test-executables-table)
        - [Submissions Table](#submissions-table)
        - [Files Table](#files-table)
            - [User Test Files Table](#user-test-files-table)
        - [Attachements Table](#attachements-table)
    * Results Tables
        - [Evaluations Table](#evaluations-table)
        - [Submission Results Table](#submission-results-table)
        - [User Test Results Table](#user-test-results-table)
        - [Participations Table](#participations-table)


# Users Table

## Description
> This table stores the list of all entered users. Adding a user to CMS does not guarantee the access to the contests. To grant an access to the contests, user shall exists in a participation table.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||first_name| First name|
||last_name| Last name|
||username| Login name of the user. In IOI, it's usually associated with the country code. Example: 'AZE1', 'ITA3' and 'SWE2'|
||password| A password of the user is stored here. It can be plain or encrypted text|
||email| Email of the user|
||timezone| Timezone of the user|
||preferred_languages| The languages that the user knows|

### Entity
    +----------------------------------------------------------------------------------------------------+
    |                                              Table Users                                           |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | first_name                    | character varying                        | not null                |
    | last_name                     | character varying                        | not null                |
    | username                      | character varying                        | not null                |
    | password                      | character varying                        | not null                |
    | email                         | character varying                        |                         |
    | timezone                      | character varying                        |                         |
    | preferred_languages           | character varying[]                      | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +-----------------------+-----------------------------+-----------------------+----------------------+
    |    PRIMARY KEY        |        FOREIGN KEY          |    REFERENCES         |     CONSTRAINT       |
    +-----------------------|-----------------------------|----------------------------------------------+
    | id                    |                             |                       |                      |
    +-----------------------|-----------------------------|----------------------------------------------+
    |                       |                             |                       |  UNIQUE(username)    |
    +----------------------------------------------------------------------------------------------------+


***** 


# Admins Table

## Description
> This table stores the names and tokens of administrators
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||name| Full name of administrator, free-type field|
||username| Unique username of administrator, free-type field|
||authentication| Authentification token|
||enabled| Account state: enabled or disabled, binary field|
||permission_all| Superuser permissions: true or false, binary field|
||permission_messaging| Messaging privilege: true or false, binary field|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                              Table Admins                                          |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | name                          | character varying                        | not null                |
    | username                      | character varying                        | not null                |
    | authentication                | character varying                        | not null                |
    | enabled                       | boolean                                  | not null                |
    | permission_all                | boolean                                  | not null                |
    | permission_messaging          | boolean                                  | not null                |
    +-----------------------------------------------------------------------------+----------------------+
    |                                              RELATIONS                                             |
    +-----------------------+-----------------------------+----------------------------------------------+
    |    PRIMARY KEY        |        FOREIGN KEY          |    REFERENCES         |     CONSTRAINT       |
    +-----------------------|-----------------------------|----------------------------------------------+
    | id                    |                             |                       |                      |
    +----------------------------------------------------------------------------------------------------+

***** 
***** 
***** 
***** 

# Announcements Table

## Description
> This table stores the announcements made during the contests.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||timestamp| Full name of administrator, free-type field|
||subject| Unique username of administrator, free-type field|
||text| Authentification token|
|FK|contest_id| Account state: enabled or disabled, binary field|
|FK|admin_id| Superuser permissions: true or false, binary field|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                         Table Announcements                                        |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | timestamp                     | timestamp without time zone              | not null                |
    | subject                       | character varying                        | not null                |
    | text                          | character varying                        | not null                |
    | contest_id                    | integer                                  | not null                |
    | admin_id                      | integer                                  | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +-----------------------+-----------------------------+-----------------------+----------------------+
    |    PRIMARY KEY        |        FOREIGN KEY          |    REFERENCES         |     CONSTRAINT       |
    +-----------------------|-----------------------------|----------------------------------------------+
    | id                    |                             |                       |                      |
    +-----------------------|-----------------------------|----------------------------------------------+
    |                       | admin_id                    | admins(id)            | ON UPDATE CASCADE    |
    |                       |                             |                       | ON DELETE CASCADE    |
    +-----------------------|-----------------------------|----------------------------------------------+
    |                       | contest_id                  | contests(id)          | ON UPDATE CASCADE    |
    |                       |                             |                       | ON DELETE CASCADE    |
    +----------------------------------------------------------------------------------------------------+


# Attachements Table

## Description
> This table stores the attachements for the tasks
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|task_id| Unique indentifier of the task this attachment belongs to, child of tasks|
||filename| Name of the attachement, free-type field|
||digest| Stores the hash (digest of hash function) of the attachement|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Attachments                                        |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | task_id                       | integer                                  | not null                |
    | filename                      | character varying                        | not null                |
    | digest                        | character varying                        | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +-----------------------+-----------------------------+-------------------+--------------------------+
    | PRIMARY KEY           | FOREIGN KEY                 | REFERENCES        | CONSTRAINT               |
    +-----------------------|-----------------------------|----------------------------------------------+
    | id                    |                             |                   |                          |
    +-----------------------|-----------------------------|----------------------------------------------+
    |                       |                             |                   | UNIQUE(task_id,filename) |
    +-----------------------|-----------------------------|----------------------------------------------+
    |                       | task_id                     | tasks(id)         | ON UPDATE CASCADE        |
    |                       |                             |                   | ON DELETE CASCADE        |
    +----------------------------------------------------------------------------------------------------+


# Contests Table

## Description
> This table stores the contests.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||name| Name of the contest|
||description| Description of the contest|
||allowed_localizations| Lists localization available within this contest|
||languages| Lists programming languages allowed within this contest|
||submissions_download_allowed| Can submission be downloaded: true or false, binary field|
||allow_questions| Are questions allowed: true or false, binary field|
||allow_user_tests| Are user tests allowed: true or false, binary field|
||block_hidden_participations| Are hidden participations allowed: true or false, binary field|
||allow_password_authentication| Are authentication via password allowed: true or false, binary field|
||ip_restriction| Is IP restriction enforced: true or false, binary field|
||ip_autologin| Is autologin by IP allowed: true or false, binary field|
||token_mode| This field is of special datatype and regulates whether this contest uses tokens. Can be "disabled", "infinite" or "finite"|
||token_max_number| If token mode is set to "finite", this field sets the maximum number of tokens available in this contest, otherwise left empty|
||token_min_interval| If token mode is used and the token has been used, this field defines the minimum amount of time contestant has to wait before another token can be used|
||token_gen_initial| If token mode is set to "finite", this field defines the amount of tokens available when contest begins. Counter decrements by 1 each time contestant uses a token|
||token_gen_number| Full name of administrator, free-type field|
||token_gen_interval| Unique username of administrator, free-type field|
||token_gen_max| If token mode is set to "finite", this field defines the maximum amount of tokens that can be generated in this contest|
||start| Timestamp of the contest start|
||stop| Timestamp of the contest finish|
||analysis_enabled| Is contest analysis enabled: true or false, binary field|
||analysis_start| Timestamp of the analysis start|
||analysis_stop| Timestamp of the analysis finish|
||timezone| Timezone of the contest|
||per_user_time| If set to non-null value, this fields regulate the amount of time contestant can participate in the timeframe of the contest|
||max_submission_number| This field sets the maximum number of submission each participant can make per contest|
||max_user_test_number| This field sets the maximum number of tests each participant can make|
||min_submission_interval| The minimum amount of time, in seconds, the user is required to wait after a submission has been submitted before next one can be submitted|
||min_user_test_interval| The minimum amount of time, in seconds, the user is required to wait after a test has been submitted before next one can be submitted|
||score_precision| This field sets the precision of the score showed to participants in amount of decimals in float number|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                              Table Contests                                        |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                           | Nullable               |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                   | not null               |
    | name                          | character varying                         | not null               |
    | description                   | character varying                         | not null               |
    | allowed_localizations         | character varying[]                       | not null               |
    | languages                     | character varying[]                       | not null               |
    | submissions_download_allowed  | boolean                                   | not null               |
    | allow_questions               | boolean                                   | not null               |
    | allow_user_tests              | boolean                                   | not null               |
    | block_hidden_participations   | boolean                                   | not null               |
    | allow_password_authentication | boolean                                   | not null               |
    | ip_restriction                | boolean                                   | not null               |
    | ip_autologin                  | boolean                                   | not null               |
    | token_mode                    | token_mode                                | not null               |
    | token_max_number              | integer                                   |                        |
    | token_min_interval            | interval                                  | not null               |
    | token_gen_initial             | integer                                   | not null               |
    | token_gen_number              | integer                                   | not null               |
    | token_gen_interval            | interval                                  | not null               |
    | token_gen_max                 | integer                                   |                        |
    | start                         | timestamp without time zone               | not null               |
    | stop                          | timestamp without time zone               | not null               |
    | analysis_enabled              | boolean                                   | not null               |
    | analysis_start                | timestamp without time zone               | not null               |
    | analysis_stop                 | timestamp without time zone               | not null               |
    | start                         | timestamp without time zone               | not null               |
    | timezone                      | character varying                         |                        |
    | per_user_time                 | interval                                  |                        |
    | max_submission_number         | integer                                   |                        |
    | max_user_test_number          | integer                                   |                        |
    | min_submission_interval       | interval                                  |                        |
    | min_user_test_interval        | interval                                  |                        |
    | score_precision               | integer                                   | not null               |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +----------------+---------------------+----------------+--------------------------------------------+
    | PRIMARY KEY | FOREIGN KEY | REFERENCES |     CONSTRAINT                                            |
    +-------------|-------------|------------------------------------------------------------------------+
    | id          |             |            |                                                           |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | UNIQUE(name)                                              |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (start <= stop)                                     |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (stop <= analysis_start)                            |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (analysis_start <= analysis_stop)                   |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (token_gen_initial <= token_gen_max)                |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (max_submission_number > 0)                         |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (max_user_test_number > 0)                          | 
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (min_submission_interval > '00:00:00'::interval)    |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (min_user_test_interval > '00:00:00'::interval)     |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (per_user_time >= '00:00:00'::interval)             |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (score_precision >= 0)                              |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (token_gen_initial >= 0)                            |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (token_gen_interval > '00:00:00'::interval)         |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (token_gen_max > 0)                                 |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (token_gen_number >= 0)                             |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (token_max_number > 0)                              |
    +-------------|-------------|------------------------------------------------------------------------+
    |             |             |            | CHECK (token_min_interval >= '00:00:00'::interval)        |
    +----------------------------------------------------------------------------------------------------+


# Datasets Table

## Description
> This table stores the datasets
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|task_id| Unique indentifier of the task this attachment belongs to, child of tasks|
||description| Description of the dataset|
||autojudge| Is auto judging enabled for this dataset: true or false, binary field|
||time_limit| If used, sets the time limit on dataset availability|
||memory_limit| Limits the size of the dataset|
||task_type| Stores the type of task this dataset is associated with|
||task_type_parameters| Stores a json of task parameters|
||score_type| Type of scoring associated with this dataset|
||score_type_parameters| Stores a json of scoring parameters|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Datasets                                           |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | task_id                       | integer                                  | not null                |
    | description                   | character varying                        | not null                |
    | autojudge                     | boolean                                  | not null                |
    | time_limit                    | double precision                         |                         |
    | memory_limit                  | bigint                                   |                         |
    | task_type                     | character varying                        | not null                |
    | task_type_parameters          | jsonb                                    | not null                |
    | score_type                    | character varying                        | not null                |
    | score_type_parameters         | jsonb                                    | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +------------------ +---------------------+---------------+------------------------------------------+
    |    PRIMARY KEY    |     FOREIGN KEY     |   REFERENCES  |     CONSTRAINT                           |
    +-------------------|---------------------|---------------|------------------------------------------+
    | id                |                     |               |                                          |
    +-------------------|---------------------|---------------|------------------------------------------+
    |                   |                     |               | UNIQUE(id, task_id)                      |
    +-------------------|---------------------|---------------|------------------------------------------+
    |                   |                     |               | UNIQUE(task_id, description)             |
    +-------------------|---------------------|---------------|------------------------------------------+
    |                   |                     |               | CHECK (memory_limit > 0)                 |
    +-------------------|---------------------|---------------|------------------------------------------+
    |                   |                     |               | CHECK (time_limit > 0::double precision) |
    +-------------------|---------------------|---------------|------------------------------------------+
    |                   | task_id             | tasks(id)     | ON UPDATE CASCADE                        |
    |                   |                     |               | ON DELETE CASCADE                        |
    +----------------------------------------------------------------------------------------------------+


# Evaluations Table

## Description
> This table stores the evaluations
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|submission_id| Unique ID of the submission, child of submissions|
|FK|dataset_id| Unique ID of the dataset, child of datasets|
|FK|testcase_id| Unique ID of the testcase, child of testcases|
||outcome| Stores the outcome of the evaluation|
||text| The text of the evaluation, expanding on outcome|
||execution_time| The amount of CPU time it took to execute the subject of evaluation|
||execution_wall_clock_time| The total amount of time it took to execute the subject of evaluation|
||execution_memory| The amount of memory used during evaluation|
||evaluation_shard| The amount of shards used|
||evaluation_sandbox| Sandbox used in evaluation|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Evaluations                                        |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | submission_id                 | integer                                  | not null                |
    | dataset_id                    | integer                                  | not null                |
    | testcase_id                   | integer                                  | not null                |
    | outcome                       | character varying                        |                         |
    | text                          | character varying[]                      | not null                |
    | autojudge                     | boolean                                  | not null                |
    | execution_time                | double precision                         |                         |
    | execution_wall_clock_time     | double precision                         |                         |
    | execution_memory              | bigint                                   |                         |
    | evaluation_shard              | integer                                  |                         |
    | evaluation_sandbox            | character varying                        |                         |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +------------+-----------------+---------------------+-----------------------------------------------+
    | PRIMARY KEY|   FOREIGN KEY   |    REFERENCES       |     CONSTRAINT                                |
    +------------|-----------------|---------------------------------------------------------------------+
    | id         |                 |                     |                                               |
    +------------|-----------------|---------------------------------------------------------------------+
    |            |                 |                     | UNIQUE(submission_id, dataset_id, testcase_id)|
    +------------|-----------------|---------------------------------------------------------------------+
    |            |                 |                     | UNIQUE(task_id, description)                  |
    +------------|-----------------|---------------------------------------------------------------------+
    |            |                 |                     | CHECK (memory_limit > 0)                      |
    +------------|-----------------|---------------------------------------------------------------------+
    |            |                 |                     | CHECK (time_limit > 0::double precision)      |
    +------------|-----------------|---------------------------------------------------------------------+
    |            | dataset_id      | datasets(id)        | ON UPDATE CASCADE                             |
    |            |                 |                     | ON DELETE CASCADE                             |
    +------------|-----------------|---------------------------------------------------------------------+
    |            | (submission_id, | submission_results( | ON UPDATE CASCADE                             |
    |            |  dataset_id)    |    submission_id,   | ON DELETE CASCADE                             |
    |            |                 |    dataset_id       |                                               |
    |            |                 | )                   |                                               |
    +------------|-----------------|---------------------------------------------------------------------+
    |            | submission_id   | submissions(id)     | ON UPDATE CASCADE                             |
    |            |                 |                     | ON DELETE CASCADE                             |
    +------------|-----------------|---------------------------------------------------------------------+
    |            | testcase_id     | testcases(id)       | ON UPDATE CASCADE                             |
    |            |                 |                     | ON DELETE CASCADE                             |
    +----------------------------------------------------------------------------------------------------+



# Executables Table

## Description
> This table stores the executables submitted by contestants.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|submission_id| Unique ID of the submission, child of submissions|
|FK|dataset_id| Unique ID of the dataset, child of datasets|
||filename| Filename of the executable|
||digest| Stores the hash (digest of hash function) of the executable|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Executables                                        |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | submission_id                 | integer                                  | not null                |
    | dataset_id                    | integer                                  | not null                |
    | filename                      | character varying                        | not null                |
    | digest                        | character varying                        | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +-------------+-----------------------------+-----------------------+--------------------------------+
    | PRIMARY KEY | FOREIGN KEY       | REFERENCES          | CONSTRAINT                                 |
    +-------------|-------------------|------------------------------------------------------------------+
    | id          |                   |                     |                                            |
    +-------------|-------------------|------------------------------------------------------------------+
    |             |                   |                     | UNIQUE(submission_id, dataset_id, filename)|
    +-------------|-------------------|------------------------------------------------------------------+
    |             | dataset_id        | datasets(id)        | ON UPDATE CASCADE                          |
    |             |                   |                     | ON DELETE CASCADE                          |
    +-------------|-------------------|------------------------------------------------------------------+
    |             | (submission_id,   | submission_results( | ON UPDATE CASCADE                          |
    |             |  dataset_id)      |    submission_id,   | ON DELETE CASCADE                          |
    |             |                   |    dataset_id)      |                                            |
    |             |                   | )                   |                                            |
    +-------------|-------------------|------------------------------------------------------------------+
    |             | submission_id     | submissions(id)     | ON UPDATE CASCADE                          |
    |             |                   |                     | ON DELETE CASCADE                          |
    +----------------------------------------------------------------------------------------------------+


# Files Table

## Description
> This table stores the files submitted by contestants
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|submission_id| Unique ID of the submission, child of submissions|
||filename| Name of the file|
||digest| Stores the hash (digest of hash function) of the file|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Files                                              |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | submission_id                 | integer                                  | not null                |
    | filename                      | character varying                        | not null                |
    | digest                        | character varying                        | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +--------------------+------------------------+--------------------+---------------------------------+
    | PRIMARY KEY        | FOREIGN KEY            | REFERENCES         | CONSTRAINT                      |
    +--------------------|------------------------|------------------------------------------------------+
    | id                 |                        |                    |                                 |
    +--------------------|------------------------|------------------------------------------------------+
    |                    |                        |                    | UNIQUE(submission_id, filename) |
    +--------------------|------------------------|------------------------------------------------------+
    |                    | submission_id          | submissions(id)    | ON UPDATE CASCADE               |
    |                    |                        |                    | ON DELETE CASCADE               |
    +----------------------------------------------------------------------------------------------------+


# Fs Objects Table

## Description
> This table stores the log of object-related events.
    
|Idx|Attribute|Description|
|:---|:---|:---|
||digest| Stores the hash (digest of hash function) of the event|
||loid| Unique object ID|
||description| Decription of the event|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Fsobjects                                          |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+------------------------------------------+-------------------------+
    | digest                        | character varying                        | not null                |
    | loid                          | loid                                     | not null                |
    | description                   | character varying                        | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +-----------------------+-----------------------------+-----------------------+----------------------+
    | PRIMARY KEY           | FOREIGN KEY                 | REFERENCES            | CONSTRAINT           |
    +-----------------------|-----------------------------|----------------------------------------------+
    | digest                |                             |                       |                      |
    +----------------------------------------------------------------------------------------------------+


# Managers Table

## Description
> This table stores the so-called managers, grading scripts for allowed languages per dataset.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|submission_id| Unique ID of the submission, child of submissions|
||dataset_id| Unique ID of the dataset, child of datasets|
||filename| The filename of the manager|
||digest| Stores the hash (digest of hash function) of the manager|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Managers                                           |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | dataset_id                    | integer                                  | not null                |
    | filename                      | character varying                        | not null                |
    | digest                        | character varying                        | not null                |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +---------------------+------------------------+-----------------------+-----------------------------+
    | PRIMARY KEY         | FOREIGN KEY            | REFERENCES            | CONSTRAINT                  |
    +---------------------|------------------------|-----------------------------------------------------+
    | id                  |                        |                       |                             |
    +---------------------|------------------------|-----------------------------------------------------+
    |                     |                        |                       | UNIQUE(dataset_id, filename)|
    +---------------------|------------------------|-----------------------------------------------------+
    |                     | dataset_id             | datasets(id)          | ON UPDATE CASCADE           |
    |                     |                        |                       | ON DELETE CASCADE           |
    +----------------------------------------------------------------------------------------------------+



# Messages Table

## Description
> This table stores direct messages sent to contestants.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||timestamp| Timestamp of when the message was sent|
||subject| Subject of the message|
||text| Text of the message|
|FK|participation_id| Unique ID of the participant to whom the message was sent, child of participants|
|FK|admin_id| Unique ID of the administrator who sent the message, child of administrators|

### Entity

    +----------------------------------------------------------------------------------------------------+
    |                                           Table Messages                                           |
    +----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                |
    |-------------------------------+-------------------------------------------+------------------------+
    | id(auto)                      | integer                                  | not null                |
    | timestamp                     | timestamp without time zone              | not null                |
    | subject                       | character varying                        | not null                |
    | text                          | character varying                        | not null                |
    | participation_id              | integer                                  | not null                |
    | admin_id                      | integer                                  |                         |
    +----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                             |
    +-----------------------+-----------------------------+-----------------------+----------------------+
    | PRIMARY KEY           | FOREIGN KEY                 | REFERENCES            | CONSTRAINT           |
    +-----------------------|-----------------------------|----------------------------------------------+
    | id                    |                             |                       |                      |
    +-----------------------|-----------------------------|----------------------------------------------+
    |                       | admin_id                    | admins(id)            | ON UPDATE CASCADE    |
    |                       |                             |                       | ON DELETE CASCADE    |
    +-----------------------|-----------------------------|----------------------------------------------+
    |                       | participation_id            | participations(id)    | ON UPDATE CASCADE    |
    |                       |                             |                       | ON DELETE CASCADE    |
    +----------------------------------------------------------------------------------------------------+




# Participations Table

## Description
> This table stores the access of users to the contests.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||ip| If access is login based, then the IP or mask is stored here|
||starting_time| the start time of the access|
||delay_time| If participation of contestant was delayed, the delay time is stored here|
||extra_time| an extension time for the particular user|
||password| a password (plan or encrypted) for accessing a contests|
||hidden| if '1', then the scores of the user will not be shown in Ranking|
||unrestricted| If '1', then participation is not restricted|
|FK|contest_id| Unique ID of the contest, child of contests|
|FK|user_id| Unique ID of the user, child of users|
|FK|team_id| Unique ID of the user's team, child of teams|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Participations                                      |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | ip                            | cidr[]                                   |                          |
    | starting_time                 | timestamp without time zone              |                          |
    | delay_time                    | interval                                 | not null                 |
    | extra_time                    | interval                                 | not null                 |
    | password                      | character varying                        |                          |
    | hidden                        | boolean                                  | not null                 |
    | unrestricted                  | boolean                                  | not null                 |
    | contest_id                    | integer                                  | not null                 |
    | user_id                       | integer                                  | not null                 |
    | team_id                       | integer                                  |                          |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +--------------+-------------------+---------------------+--------------------------------------------+
    | PRIMARY KEY  | FOREIGN KEY       | REFERENCES          | CONSTRAINT                                 |
    +--------------|-------------------|------------------------------------------------------------------+
    | id           |                   |                     |                                            |
    +--------------|-------------------|------------------------------------------------------------------+
    |              |                   |                     | UNIQUE(contest_id, user_id)                |
    +--------------|-------------------|------------------------------------------------------------------+
    |              |                   |                     | CHECK (delay_time >= '00:00:00'::interval) |
    +--------------|-------------------|------------------------------------------------------------------+
    |              |                   |                     | CHECK (extra_time >= '00:00:00'::interval) |
    +--------------|-------------------|------------------------------------------------------------------+
    |              | contest_id        | contest(id)         | ON UPDATE CASCADE                          |
    |              |                   |                     | ON DELETE CASCADE                          |
    +--------------|-------------------|------------------------------------------------------------------+
    |              | team_id           | teams(id)           | ON UPDATE CASCADE                          |
    |              |                   |                     | ON DELETE CASCADE                          |
    +--------------|-------------------|------------------------------------------------------------------+
    |              | user_id           | users(id)           | ON UPDATE CASCADE                          |
    |              |                   |                     | ON DELETE CASCADE                          |
    +-----------------------------------------------------------------------------------------------------+


# Print Jobs Table

## Description
> This table stores the print jobs log.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|participation_id| Unique participation ID, child of participations|
||timestamp| Timestamp of the print job|
||filename| Printed filename|
||digest| Stores the hash (digest of hash function) of the printjob|
||done| Is the print job done: true or false, binary field|
||status| Status of the job|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Printjobs                                           |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | participation_id              | integer                                  | not null                 |
    | timestamp                     | timestamp without time zone              | not null                 |
    | filename                      | character varying                        | not null                 |
    | digest                        | character varying                        | not null                 |
    | done                          | boolean                                  | not null                 |
    | status                        | character varying[]                      | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-------------------------+---------------------+-----------------------------+
    | PRIMARY KEY           | FOREIGN KEY             | REFERENCES          | CONSTRAINT                  |
    +-----------------------|-------------------------|---------------------------------------------------+
    | id                    |                         |                     |                             |
    +-----------------------|-------------------------|---------------------------------------------------+
    |                       |                         |                     | UNIQUE(task_id, filename)   |
    +-----------------------|-------------------------|---------------------------------------------------+
    |                       | participation_id        | participations(id)  | ON UPDATE CASCADE           |
    |                       |                         |                     | ON DELETE CASCADE           |
    +-----------------------------------------------------------------------------------------------------+




# Questions Table

## Description
> This table stores requests and questions from the participants during the contest.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||question_timestamp| Precise timestamp of the request|
||subject| Subject of the request or question|
||text| The body of the request or question|
||reply_timestamp| Timestamp of the reply by staff|
||ignored| Is question ignored: true or false, binary field|
||reply_subject| The subject of the reply to the question or request|
||reply_text| The body of the reply|
|FK|participation_id| Unique ID of participant, child of participations|
|FK|admin_id| Unique ID of administrator, child of admins|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Questions                                           |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | question_timestamp            | timestamp without time zone              | not null                 |
    | subject                       | character varying                        | not null                 |
    | text                          | character varying                        | not null                 |
    | reply_timestamp               | timestamp without time zone              |                          |
    | ignored                       | boolean                                  | not null                 |
    | reply_subject                 | character varying                        |                          |
    | reply_text                    | character varying                        |                          |
    | participation_id              | integer                                  | not null                 |
    | admin_id                      | integer                                  |                          |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-----------------------+-----------------------+-----------------------------+
    | PRIMARY KEY           | FOREIGN KEY           | REFERENCES            | CONSTRAINT                  |
    +-----------------------|-----------------------|-----------------------------------------------------+
    | id                    |                       |                       |                             |
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       |                       |                       | UNIQUE(task_id, filename)   |
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       | admin_id              | admins(id)            | ON UPDATE CASCADE           |
    |                       |                       |                       | ON DELETE CASCADE           |
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       | participation_id      | participations(id)    | ON UPDATE CASCADE           |
    |                       |                       |                       | ON DELETE CASCADE           |
    +-----------------------------------------------------------------------------------------------------+




# Statements Table

## Description
> This table stores task statements in different languages.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|task_id| Unique task ID, child of tasks|
||language| Language code of the statement|
||digest| Stores the hash (digest of hash function) of the statement|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Statements                                          |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | task_id                       | integer                                  | not null                 |
    | language                      | character varying                        | not null                 |
    | digest                        | character varying                        | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-----------------------------+------------------+----------------------------+
    | PRIMARY KEY           | FOREIGN KEY                 | REFERENCES       | CONSTRAINT                 |
    +-----------------------|-----------------------------|-----------------------------------------------+
    | id                    |                             |                  |                            |
    +-----------------------|-----------------------------|-----------------------------------------------+
    |                       |                             |                  | UNIQUE(task_id, language)  |
    +-----------------------|-----------------------------|-----------------------------------------------+
    |                       | task_id                     | tasks(id)        | ON UPDATE CASCADE          |
    |                       |                             |                  | ON DELETE CASCADE          |
    +-----------------------------------------------------------------------------------------------------+

# Submission Results Table

## Description
> This table stores the result of each submission.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK/FK|submission_id| Unique ID of the submission, child of submissions, part of Primary Key|
|PK/FK|dataset_id| Unique ID of the dataset, child of datasets, part of Primary Key|
||compilation_outcome| Stores the compilation outcome in a special datatype: can be ok or fail|
||compilation_text| Stores the status of the compilation|
||compilation_tries| Stores the compilation tries count|
||compilation_stdout| Stores the output of the compilator|
||compilation_stderr| Stores the error produced by the compilator|
||compilation_time| The amount of CPU time spent on compilation|
||compilation_wall_clock_time| Total amount of time spent on compilation|
||compilation_memory| The amount of memory used by the compilator|
||compilation_shard| Shards split by the compilator|
||compilation_sandbox| Stores the location of the sandbox used in compilation|
||evaluation_outcome| Stores the outcome of the evaluation in a special datatype, can be either OK or null|
||evaluation_tries| Amount of [additional] evaluation tries|
||score| Score of the evaluation|
||score_details| Stores json object with scoring details|
||public_score| Score of the evaluation, available to public|
||public_score_details| Stores json object with public scoring details|
||ranking_score_details| Details and ranks|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Submission Results                                  |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | submission_id                 | integer                                  | not null                 |
    | dataset_id                    | integer                                  | not null                 |
    | compilation_outcome           | compilation_outcome                      |                          |
    | compilation_text              | character varying[]                      | not null                 |
    | compilation_tries             | integer                                  | not null                 |
    | compilation_stdout            | character varying                        |                          |
    | compilation_stderr            | character varying                        |                          |
    | compilation_time              | double precision                         |                          |
    | compilation_wall_clock_time   | double precision                         |                          |
    | compilation_memory            | bigint                                   |                          |
    | compilation_shard             | integer                                  |                          |
    | compilation_sandbox           | character varying                        |                          |
    | evaluation_outcome            | evaluation_outcome                       |                          |
    | evaluation_tries              | integer                                  | not null                 |
    | score                         | double precision                         |                          |
    | score_details                 | jsonb                                    |                          |
    | public_score                  | double precision                         |                          |
    | public_score_details          | jsonb                                    |                          |
    | ranking_score_details         | character varying[]                      |                          |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------------+-----------------------------+--------------------+--------------------+
    | PRIMARY KEY                 | FOREIGN KEY                    | REFERENCES         | CONSTRAINT      |
    +-----------------------------|-----------------------------|-----------------------------------------+
    | (submission_id, dataset_id) |                             |                    |                    |
    +-----------------------------|-----------------------------|-----------------------------------------+
    |                             | dataset_id                  | datasets(id)       | ON UPDATE CASCADE  |
    |                             |                             |                    | ON DELETE CASCADE  |
    +-----------------------------|-----------------------------|-----------------------------------------+
    |                             | submission_id               | submissions(id)    | ON UPDATE CASCADE  |
    |                             |                             |                    | ON DELETE CASCADE  |
    +-----------------------------------------------------------------------------------------------------+


# Submissions Table

## Description
> This table stores submission details.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||participation_id| Unique ID of the participation, child of participations|
||task_id| Unique ID of the task, child of tasks|
||timestamp| Precise timestamp of the submission|
||language| Programming language of the submission|
||comment| Free type field for comments|
||official| Is the submission official: true or false, binary field|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Submissions                                         |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | task_id                       | integer                                  | not null                 |
    | participation_id              | integer                                  | not null                 |
    | timestamp                     | timestamp without time zone              | not null                 |
    | language                      | character varying                        |                          |
    | comment                       | character varying                        | not null                 |
    | official                      | boolean                                  | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-----------------------+-----------------------+-----------------------------+
    | PRIMARY KEY           | FOREIGN KEY           | REFERENCES            | CONSTRAINT                  |
    +-----------------------|-----------------------|-----------------------------------------------------+
    | id                    |                       |                       |                             |
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       |                       |                       | UNIQUE(task_id, filename)   |
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       | task_id               | tasks(id)             | ON UPDATE CASCADE           |
    |                       |                       |                       | ON DELETE CASCADE           |
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       | participation_id      | participations(id)    | ON UPDATE CASCADE           |
    |                       |                       |                       | ON DELETE CASCADE           |
    +-----------------------------------------------------------------------------------------------------+


# Tasks Table

## Description
> This table stores tasks information.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
||num| Order of this task in the contest|
|FK|contest_id| Unique ID of the contest this task belongs to, child of contests|
||name| Name of the task|
||title| Title of the task|
||submission_format| Format, in which submissions will be accepted|
||primary_statements| Associated primary statement, if available. Most likely to be referring to the language of the statement|
||token_mode| This field is of special datatype and regulates whether this task uses tokens. Can be "disabled", "infinite" or "finite"|
||token_max_number| If token mode is set to "finite", this field sets the maximum number of tokens available for this task, otherwise left empty|
||token_min_interval| If token mode is used and the token has been used, this field defines the minimum amount of time contestant has to wait before another token can be used|
||token_gen_initial| If token mode is set to "finite", this field defines the amount of tokens available when task begins. Counter decrements by 1 each time contestant uses a token|
||token_gen_number| If token mode is set to "finite", this field defines the amount of tokens added every selected interval to the contestants|
||token_gen_interval| If token mode is set to "finite", this field defines the interval between new tokens generation|
||token_gen_max| If token mode is set to "finite", this field defines the maximum amount of tokens that can be generated for this task|
||max_submission_number| This field sets the maximum number of submission each participant can make per task|
||max_user_test_number| This field sets the maximum number of tests each participant can make per task|
||min_submission_interval| The minimum amount of time, in seconds, the user is required to wait after a submission has been submitted before next one can be submitted|
||min_user_test_interval| The minimum amount of time, in seconds, the user is required to wait after a test has been submitted before next one can be submitted|
||feedback_level| Level of feedback for this task|
||score_precision| Scoring precision for this task|
||score_mode| This field is of special datatype and regulates how this task will be scored|
|FK|dataset_id| Unique ID of the dataset used for this task, child of datasets|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                              Table Tasks                                            |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                           | Nullable                |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                   | not null                |
    | num                           | integer                                   |                         |
    | contest_id                    | integer                                   |                         |
    | name                          | character varying                         | not null                |
    | title                         | character varying                         | not null                |
    | submission_format             | character varying[]                       | not null                |
    | primary_statements            | character varying[]                       | not null                |
    | token_mode                    | token_mode                                | not null                |
    | token_max_number              | integer                                   |                         |
    | token_min_interval            | interval                                  | not null                |
    | token_gen_initial             | integer                                   | not null                |
    | token_gen_number              | integer                                   | not null                |
    | token_gen_interval            | interval                                  | not null                |
    | token_gen_max                 | integer                                   |                         |
    | max_submission_number         | integer                                   |                         |
    | max_user_test_number          | integer                                   |                         |
    | min_submission_interval       | interval                                  |                         |
    | min_user_test_interval        | interval                                  |                         |
    | feedback_level                | feedback_level                            | not null                |
    | score_precision               | integer                                   | not null                |
    | score_mode                    | score_mode                                | not null                |
    | active_dataset_id             | integer                                   |                         |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+----------------------+--------------+---------------------------------------+
    | PRIMARY KEY  | FOREIGN KEY          | REFERENCES   | CONSTRAINT                                     |
    +--------------|----------------------|---------------------------------------------------------------+
    | id           |                      |              |                                                |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | UNIQUE(name)                                   |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | UNIQUE(contest_id, num)                        |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | UNIQUE(contest_id, name)                       |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (token_gen_initial <= token_gen_max)     |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (max_submission_number > 0)              |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (max_user_test_number > 0)               | 
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (min_submission_interval > '00:00:00')   |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (min_user_test_interval > '00:00:00')    |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (per_user_time >= '00:00:00')            |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (score_precision >= 0)                   |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (token_gen_initial >= 0)                 |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (token_gen_interval > '00:00:00')        |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (token_gen_max > 0)                      |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (token_gen_number >= 0)                  |
    +--------------|----------------------|---------------------------------------------------------------+
    |              |                      |              | CHECK (token_max_number > 0)                   |
    +--------------|----------------------|---------------------------------------------------------------+
    |              | (id,                 | datasets(    | ON UPDATE CASCADE                              |
    |              |  active_dataset_id)  |    task_id,  | ON DELETE CASCADE                              |
    |              |                      |    id        |                                                |
    |              |                      | )            |                                                |
    +--------------|----------------------|---------------------------------------------------------------+
    |              | contest_id           | contests(id) | ON UPDATE CASCADE                              |
    |              |                      |              | ON DELETE CASCADE                              |
    +-----------------------------------------------------------------------------------------------------+


# Teams Table

## Description
> Stores the list of teams, like 'AZE', 'FRA' and 'USA'.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| The unique ID of the team|
||code| A short description of the team. In IOI, it's a country code in **ISO 3166-1 alpha-3 code** format|
||name| Full description of the team. In IOI, the name of the country.|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Teams                                               |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | code                          | character varying                        | not null                 |
    | name                          | character varying                        | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-----------------------------+-----------------------+-----------------------+
    | PRIMARY KEY           | FOREIGN KEY                 | REFERENCES            | CONSTRAINT            |
    +-----------------------|-----------------------------|-----------------------------------------------+
    | id                    |                             |                       |                       |
    +-----------------------|-----------------------------|-----------------------------------------------+
    |                       |                             |                       | UNIQUE(code)          |
    +-----------------------------------------------------------------------------------------------------+


# Testcases Table

## Description
> Stores the details of testcases.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|dataset_id| Unique ID of the dataset used for this testcase, child of datasets|
||codename| Codename given to the testcase|
||public| Is this testcase public: true or false, binary field|
||input| Input for the testcase|
||output| Output of the testcase|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Testcases                                           |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | dataset_id                    | integer                                  | not null                 |
    | codename                      | character varying                        | not null                 |
    | public                        | boolean                                  | not null                 |
    | input                         | character varying                        | not null                 |
    | onput                         | character varying                        | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-----------------------+-----------------------+-----------------------------+
    | PRIMARY KEY           | FOREIGN KEY           | REFERENCES            | CONSTRAINT                  |
    +-----------------------|-----------------------|-----------------------------------------------------+
    | id                    |                       |                       |                             |
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       |                       |                       | UNIQUE(dataset_id, codename)|
    +-----------------------|-----------------------|-----------------------------------------------------+
    |                       | dataset_id            | datasets(id)          | ON UPDATE CASCADE           |
    |                       |                       |                       | ON DELETE CASCADE           |
    +-----------------------------------------------------------------------------------------------------+


# Tokens Table

## Description
> Stores tokens given or used if token_mode is enabled.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|submission_id| Unique value of the submission that used this token, child of submissions|
||timestamp| Timestamp of consumption|
||public| Is this testcase public: true or false, binary field|
||input| Input for the testcase|
||output| Output of the testcase|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table Tokens                                              |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | submission_id                 | integer                                  | not null                 |
    | timestamp                     | timestamp without time zone              | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-----------------------------+-----------------------+-----------------------+
    | PRIMARY KEY           | FOREIGN KEY                 | REFERENCES            | CONSTRAINT            |
    +-----------------------|-----------------------------|-----------------------------------------------+
    | id                    |                             |                       |                       |
    +-----------------------|-----------------------------|-----------------------------------------------+
    |                       |                             |                       | UNIQUE(submission_id) |
    +-----------------------|-----------------------------|-----------------------------------------------+
    |                       | submission_id               | submissions(id)       | ON UPDATE CASCADE     |
    |                       |                             |                       | ON DELETE CASCADE     |
    +-----------------------------------------------------------------------------------------------------+



# User Test Executables Table

## Description
> This table stores the test executables information.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|user_test_id| Unique ID of the user test, child of user_tests|
|FK|dataset_id| Unique ID of the dataset used, child of datasets|
||filename| Filename of the test executable|
||digest| Stores the hash (digest of hash function) of the test executable|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table User Test Executables                               |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | user_test_id                  | integer                                  | not null                 |
    | dataset_id                    | integer                                  | not null                 |
    | filename                      | character varying                        | not null                 |
    | digest                        | character varying                        | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +---------------+-----------------+--------------------+----------------------------------------------+
    | PRIMARY KEY   | FOREIGN KEY     | REFERENCES         | CONSTRAINT                                   |
    +---------------|-----------------|-------------------------------------------------------------------+
    | id            |                 |                    |                                              |
    +---------------|-----------------|-------------------------------------------------------------------+
    |               |                 |                    | UNIQUE(user_test_id, dataset_id, filename)   |
    +---------------|-----------------|-------------------------------------------------------------------+
    |               | dataset_id      | datasets(id)       | ON UPDATE CASCADE                            |
    |               |                 |                    | ON DELETE CASCADE                            |
    +---------------|-----------------|-------------------------------------------------------------------+
    |               | (user_test_id,  | user_test_results( | ON UPDATE CASCADE                            |
    |               |  dataset_id)    |    user_test_id,   | ON DELETE CASCADE                            |
    |               |                 |     dataset_id     |                                              |
    |               |                 | )                  |                                              |
    +---------------|-----------------|-------------------------------------------------------------------+
    |               | user_test_id    | user_tests(id)     | ON UPDATE CASCADE                            |
    |               |                 |                    | ON DELETE CASCADE                            |
    +-----------------------------------------------------------------------------------------------------+



# User Test Files Table

## Description
> This table stores the test files information.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|user_test_id| Unique ID of the user test, child of user_tests|
||filename| Name of the test file|
||digest| Stores the hash (digest of hash function) of the test file|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table User Test Files                                     |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | user_test_id                  | integer                                  | not null                 |
    | filename                      | character varying                        | not null                 |
    | digest                        | character varying                        | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------+-----------------------------+---------------------+-------------------------------+
    | PRIMARY KEY     | FOREIGN KEY                 | REFERENCES          | CONSTRAINT                    |
    +-----------------|-----------------------------|-----------------------------------------------------+
    | id              |                             |                     |                               |
    +-----------------|-----------------------------|-----------------------------------------------------+
    |                 |                             |                     | UNIQUE(user_test_id, filename)|
    +-----------------|-----------------------------|-----------------------------------------------------+
    |                 | user_test_id                | user_tests(id)      | ON UPDATE CASCADE             |
    |                 |                             |                     | ON DELETE CASCADE             |
    +-----------------------------------------------------------------------------------------------------+



# User Test Managers Table

## Description
> This table stores the so-called test managers, grading scripts for allowed languages per dataset.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|user_test_id| Unique ID of the user test, child of user_tests|
||filename| Name of the file containing test manager|
||digest| Stores the hash (digest of hash function) of the test manager file|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table User Test Managers                                  |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | user_test_id                  | integer                                  | not null                 |
    | filename                      | character varying                        | not null                 |
    | digest                        | character varying                        | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+--------------------+-----------------------+--------------------------------+
    | PRIMARY KEY           | FOREIGN KEY        | REFERENCES            | CONSTRAINT                     |
    +-----------------------|--------------------|--------------------------------------------------------+
    | id                    |                    |                       |                                |
    +-----------------------|--------------------|--------------------------------------------------------+
    |                       |                    |                       | UNIQUE(user_test_id, filename) |
    +-----------------------|--------------------|--------------------------------------------------------+
    |                       | user_test_id       | user_tests(id)        | ON UPDATE CASCADE              |
    |                       |                    |                       | ON DELETE CASCADE              |
    +-----------------------------------------------------------------------------------------------------+



# User Test Results Table

## Description
> This table stores the results of test evaluations.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK/FK|user_test_id| Unique ID of the user test, child of user_tests, part of the primary key|
|PK/FK|dataset_id| Unique ID of the dataset, child of datasets, part of the primary key|
||output| Output of the test|
||compilation_outcome| Compilation outcome of the test compilation|
||compilation_text| Text of the compilation|
||compilation_tries| Amount of times compilation was attempted|
||compilation_stdout| Output of the compiler|
||compilation_stderr| Error output of the compiler|
||compilation_time| Amount of CPU time used during compilation|
||compilation_wall_clock_time| Total amount of time used during compilation|
||compilation_memory| Amount of memory used during compilation|
||compilation_shard| Shards used during compilation|
||compilation_sandbox| Address of the sandbox used for compilation|
||evaluation_outcome| The outcome of the test evaluation|
||evaluation_text| Text of the evaluation|
||evaluation_tries| Amount of tries evaluation was attempted|
||execution_time| Amount of CPU time used during execution|
||execution_wall_clock_time| Total amount of time used during execution|
||execution_memory| Amount of memory used during execution|
||evaluation_shard| Amount of shards|
||evaluation_sandbox| Address of the sandbox used for evaluation|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table User Test Results                                   |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | user_test_id                  | integer                                  | not null                 |
    | dataset_id                    | integer                                  | not null                 |
    | output                        | character varying                        |                          |
    | compilation_outcome           | character varying                        |                          |
    | compilation_text              | character varying[]                      | not null                 |
    | compilation_tries             | integer                                  | not null                 |
    | compilation_stdout            | character varying                        |                          |
    | compilation_stderr            | character varying                        |                          |
    | compilation_time              | double precision                         |                          |
    | compilation_wall_clock_time   | double precision                         |                          |
    | compilation_memory            | bigint                                   |                          |
    | compilation_shard             | integer                                  |                          |
    | compilation_sandbox           | character varying                        |                          |
    | evaluation_outcome            | character varying                        |                          |
    | evaluation_text               | character varying                        | not null                 |
    | evaluation_tries              | integer                                  | not null                 |
    | execution_time                | double precision                         |                          |
    | execution_wall_clock_time     | double precision                         |                          |
    | execution_memory              | bigint                                   |                          |
    | execution_shard               | integer                                  |                          |
    | execution_sandbox             | character varying                        |                          |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------------+--------------------------+--------------------+-----------------------+
    | PRIMARY KEY                 | FOREIGN KEY              | REFERENCES         | CONSTRAINT            |
    +-----------------------------|--------------------------|--------------------------------------------+
    | (user_test_id, dataset_id)  |                          |                    |                       |
    +-----------------------------|--------------------------|--------------------------------------------+
    |                             | dataset_id               | datasets(id)       | ON UPDATE CASCADE     |
    |                             |                          |                    | ON DELETE CASCADE     |
    +-----------------------------|--------------------------|--------------------------------------------+
    |                             | user_test_id             | user_tests(id)     | ON UPDATE CASCADE     |
    |                             |                          |                    | ON DELETE CASCADE     |
    +-----------------------------------------------------------------------------------------------------+




# User Tests Table

## Description
> This table stores the user tests details.
    
|Idx|Attribute|Description|
|:---|:---|:---|
|PK|id| Autogenerated unique ID value|
|FK|participation_id| Unique ID of the participation, child of participations|
|FK|task_id| Unique ID of the task, child of tasks|
||timestamp| Precise timestamp of the test|
||language| Programming language used|
||input| Input for the test|

### Entity

    +-----------------------------------------------------------------------------------------------------+
    |                                           Table User Tests                                          |
    +-----------------------------------------------------------------------------------------------------+
    |      Column                   |            Type                          | Nullable                 |
    |-------------------------------+-------------------------------------------+-------------------------+
    | id(auto)                      | integer                                  | not null                 |
    | task_id                       | integer                                  | not null                 |
    | participation_id              | integer                                  | not null                 |
    | timestamp                     | timestamp without time zone              | not null                 |
    | language                      | character varying                        |                          |
    | input                         | character varying                        | not null                 |
    +-----------------------------------------------------------------------------------------------------+
    |                                              RELATIONS                                              |
    +-----------------------+-----------------------------+-----------------------+-----------------------+
    | PRIMARY KEY           | FOREIGN KEY                 | REFERENCES            | CONSTRAINT            |
    +-----------------------|-----------------------------|-----------------------------------------------+
    | id                    |                             |                       |                       |
    +-----------------------|-----------------------------|-----------------------------------------------+
    |                       | task_id                     | tasks(id)             | ON UPDATE CASCADE     |
    |                       |                             |                       | ON DELETE CASCADE     |
    +-----------------------|-----------------------------|-----------------------------------------------+
    |                       | participation_id            | participations(id)    | ON UPDATE CASCADE     |
    |                       |                             |                       | ON DELETE CASCADE     |
    +-----------------------------------------------------------------------------------------------------+